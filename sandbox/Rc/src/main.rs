use std::rc::Rc;

fn main() {
    // ① a を作る（この時、ヒープに箱が作られ、カウンターは「1」になる）
    let a = Rc::new(5);
    println!("① aを作った直後のカウント: {}", Rc::strong_count(&a)); // 1

    {
        // ② 別のスコープ（ブロック）の中で b を作り、a を共有する
        let b = Rc::clone(&a);
        println!("② bを作った直後のカウント: {}", Rc::strong_count(&a)); // 2

        // ちなみに、b からカウントを聞いても、a と同じヒープの箱を見ているので結果は同じです
        println!("   (bから聞いてもカウントは: {})", Rc::strong_count(&b)); // 2
    } // ③ ⚠️ここで b がスコープを抜ける（寿命が尽きる）！

    // ④ b が死んだので、Dropトレイトが働いてカウンターが -1 される
    println!("④ bが寿命を迎えた後のカウント: {}", Rc::strong_count(&a)); // 1
} // ⑤ 最後に a も寿命を迎え、カウントが 0 になる。ここで初めてヒープのデータがお掃除される！
